# AxumBoot 框架开发完整 TODO 文档

## 第一阶段：项目基础架构搭建

### 1. 创建项目基础结构和 Workspace 配置 ✅

#### 1.1 创建 Workspace 结构 ✅
- [x] ✅ 创建根目录 `axum-boot/`
- [x] ✅ 配置根 `Cargo.toml` workspace
- [x] ✅ 创建子项目目录结构：
  ```
  axum-boot/
  ├── axum-boot-core/
  ├── axum-boot-macro/
  ├── axum-boot-starter-web/
  ├── axum-boot-starter-data-mysql/
  ├── axum-boot-starter-data-redis/
  ├── examples/
  └── docs/
  ```

#### 1.2 配置开发环境 ✅
- [x] ✅ 设置 `.gitignore`
- [x] ✅ 配置 `rust-toolchain.toml`
- [ ] ❌ 设置 GitHub Actions CI/CD
- [x] ✅ 配置代码格式化规则 (`rustfmt.toml`)
- [ ] ❌ 配置 Clippy 规则

#### 1.3 版本管理策略 ✅
- [x] ✅ 定义版本号管理策略 (统一版本 0.1.0)
- [x] ✅ 设置依赖版本约束 (workspace dependencies)
- [x] ✅ 配置发布流程 (独立发布到 crates.io)

#### 1.4 开发规范 ✅ **NEW**
- [x] ✅ 创建 CLAUDE.md 开发规范文档
- [x] ✅ 定义代码注释规范（中文注释）
- [x] ✅ 定义 Git 提交规范 (feat/fix/docs 等类型)
- [x] ✅ 定义代码风格和测试规范

## 第二阶段：核心宏系统开发

### 2. 开发 axum-boot-macro 宏系统 🔄

#### 2.1 基础宏基础设施 ✅
- [x] ✅ 设置 proc-macro crate 配置
- [x] ✅ 实现宏解析工具函数 (基础版)
- [x] ✅ 创建属性解析器 (基础版)
- [x] ✅ 实现代码生成辅助函数 (基础版)

#### 2.2 应用启动相关宏 🔄
- [x] ✅ `#[AxumBootApplication]` - 应用入口宏 (基础版)
  - [x] ✅ 生成应用启动代码
  - [x] ✅ 初始化配置系统
  - [x] ✅ 启动依赖注入容器
  - [ ] ❌ 注册全局错误处理器
- [ ] ❌ `#[ComponentScan]` - 组件扫描宏
  - [ ] 扫描指定包路径
  - [ ] 自动注册组件到容器
- [ ] ❌ `#[EnableAutoConfiguration]` - 自动配置启用宏

#### 2.3 依赖注入相关宏 🔄  
- [x] ✅ `#[Component]` - 组件标记宏 (基础版)
  - [x] ✅ 生成组件注册代码
  - [ ] ❌ 处理依赖关系
- [x] ✅ `#[Service]` - 服务层标记宏 (基础版)
- [x] ✅ `#[Repository]` - 数据访问层标记宏 (基础版)
- [ ] ❌ `#[Configuration]` - 配置类标记宏
- [ ] ❌ `#[Bean]` - Bean 定义宏
- [ ] ❌ `#[Autowired]` - 依赖注入宏

#### 2.4 Web 层相关宏 ❌
- [x] ✅ `#[RestController]` - REST 控制器宏 (基础版)
- [ ] ❌ `#[RequestMapping]` - 路由映射宏
- [ ] ❌ `#[GetMapping]`, `#[PostMapping]`, `#[PutMapping]`, `#[DeleteMapping]` - HTTP 方法宏
- [ ] ❌ `#[PathVariable]` - 路径变量宏
- [ ] ❌ `#[RequestParam]` - 请求参数宏
- [ ] ❌ `#[RequestBody]` - 请求体宏

#### 2.5 数据访问相关宏
- [ ] `#[Entity]` - 实体标记宏
- [ ] `#[Table]` - 表映射宏
- [ ] `#[Column]` - 字段映射宏
- [ ] `#[Id]` - 主键标记宏
- [ ] `#[Transactional]` - 事务宏

#### 2.6 其他功能宏
- [ ] `#[LogExecutionTime]` - 执行时间日志宏
- [ ] `#[LogArgs]` - 参数日志宏
- [ ] `#[Cacheable]` - 缓存宏
- [ ] `#[ExceptionHandler]` - 异常处理器宏

## 第三阶段：核心框架开发

### 3. 开发 axum-boot-core 核心库 🔄

#### 3.1 配置系统 ✅
- [x] ✅ 配置文件解析器 (TOML/YAML/JSON)
- [x] ✅ 环境变量覆盖机制
- [x] ✅ 配置绑定到结构体
- [ ] ❌ 配置验证系统
- [ ] ❌ 热重载配置支持
- [x] ✅ `Configuration` trait 定义
- [x] ✅ 默认配置提供器 (ServerConfig, DatabaseConfig, RedisConfig, LoggingConfig)

#### 3.2 依赖注入容器 🔄
- [x] ✅ 容器核心接口设计
  ```rust
  pub struct Container {
      fn register<T>(&mut self, component: T);
      fn register_singleton<T>(&mut self, component: T);  
      fn get<T>(&self) -> Option<&T>;
      fn get_singleton<T>(&self) -> Option<Arc<T>>;  // 需要优化
  }
  ```
- [ ] ❌ Bean 生命周期管理 (Singleton, Prototype)
- [ ] ❌ 循环依赖检测和解决
- [ ] ❌ 条件装配支持
- [ ] ❌ Bean 初始化和销毁回调

#### 3.3 应用上下文 ✅
- [x] ✅ `ApplicationContext` 设计和实现
- [x] ✅ 应用启动生命周期管理
- [ ] ❌ 事件发布订阅机制
- [ ] ❌ 应用关闭钩子

#### 3.4 错误处理系统 ✅
- [x] ✅ 统一错误类型定义
- [ ] ❌ 错误码规范
- [ ] ❌ 全局异常处理器
- [x] ✅ 错误响应格式化 (ApiResponse)
- [x] ✅ 错误日志记录

#### 3.5 日志系统集成 ✅
- [x] ✅ 日志配置管理
- [x] ✅ 结构化日志支持 (基于 tracing)
- [ ] ❌ 日志级别动态调整
- [x] ✅ 日志输出格式化
- [x] ✅ 异步日志支持

#### 3.6 工具类和辅助功能 🔄
- [ ] ❌ 反射工具 (基于 `inventory` 或类似机制)
- [ ] ❌ 类型转换工具
- [x] ✅ 通用响应格式 (ApiResponse)
- [x] ✅ 分页工具 (Page, PageResult)
- [ ] ❌ 时间工具

## 第四阶段：Web 启动器开发

### 4. 开发 axum-boot-starter-web Web 启动器 ❌

#### 4.1 Axum 集成 ❌
- [ ] ❌ 自动配置 Axum 应用
- [ ] ❌ 路由自动注册机制
- [ ] ❌ 中间件链管理
- [ ] ❌ 服务器启动和关闭

#### 4.2 控制器支持 ❌
- [ ] ❌ 控制器自动扫描注册
- [ ] ❌ 请求映射解析
- [ ] ❌ 参数绑定机制
- [ ] ❌ 响应序列化

#### 4.3 中间件系统
- [ ] 请求日志中间件
- [ ] CORS 支持中间件
- [ ] 认证授权中间件
- [ ] 限流中间件
- [ ] 压缩中间件

#### 4.4 静态资源支持
- [ ] 静态文件服务
- [ ] 资源压缩
- [ ] 缓存控制

#### 4.5 WebSocket 支持
- [ ] WebSocket 连接管理
- [ ] 消息路由
- [ ] 连接池管理

## 第五阶段：数据访问启动器开发

### 5. 开发 axum-boot-starter-data-mysql MySQL 启动器

#### 5.1 数据库连接管理
- [ ] 连接池自动配置
- [ ] 连接健康检查
- [ ] 连接重试机制
- [ ] 多数据源支持

#### 5.2 ORM 集成
- [ ] SQLx 集成封装
- [ ] SeaORM 集成封装 (可选)
- [ ] 实体映射系统
- [ ] 查询构建器

#### 5.3 Repository 模式
- [ ] `Repository` trait 定义
- [ ] 基础 CRUD 操作
- [ ] 分页查询支持
- [ ] 动态查询构建
- [ ] 批量操作支持

#### 5.4 事务管理
- [ ] 声明式事务支持
- [ ] 事务传播机制
- [ ] 事务隔离级别配置
- [ ] 事务回滚机制

#### 5.5 数据库迁移
- [ ] 迁移文件管理
- [ ] 自动迁移执行
- [ ] 迁移版本控制

### 6. 开发 axum-boot-starter-data-redis Redis 启动器

#### 6.1 Redis 连接管理
- [ ] Redis 连接池配置
- [ ] 集群模式支持
- [ ] 哨兵模式支持
- [ ] 连接故障转移

#### 6.2 缓存抽象
- [ ] 缓存模板 `RedisTemplate`
- [ ] 序列化/反序列化支持
- [ ] TTL 管理
- [ ] 缓存注解支持

#### 6.3 Session 管理
- [ ] Session 存储
- [ ] Session 序列化
- [ ] Session 过期管理

#### 6.4 分布式锁
- [ ] Redis 分布式锁实现
- [ ] 锁超时机制
- [ ] 锁续期机制

## 第六阶段：示例和文档

### 7. 创建完整的示例项目

#### 7.1 基础示例 🔄
- [x] ✅ Hello World 示例 (examples/hello-world)
- [ ] ❌ 基本 CRUD 操作示例
- [ ] ❌ 配置使用示例

#### 7.2 进阶示例
- [ ] 电商系统示例
  - 用户管理模块
  - 商品管理模块
  - 订单管理模块
  - 购物车模块
- [ ] 博客系统示例
- [ ] API 网关示例

#### 7.3 集成示例
- [ ] 多数据源示例
- [ ] 缓存集成示例
- [ ] 消息队列集成示例
- [ ] 微服务示例

### 8. 编写文档和使用指南

#### 8.1 核心文档 🔄
- [x] ✅ 快速开始指南 (README.md)
- [ ] ❌ 架构设计文档
- [ ] ❌ API 参考文档
- [ ] ❌ 配置参考手册

#### 8.2 开发指南
- [ ] 注解使用指南
- [ ] 最佳实践文档
- [ ] 常见问题解答
- [ ] 故障排除指南

#### 8.3 扩展文档
- [ ] 自定义 Starter 开发指南
- [ ] 插件开发文档
- [ ] 中间件开发指南
- [ ] 贡献者指南

## 第七阶段：测试和质量保证

### 9. 编写测试用例

#### 9.1 单元测试
- [ ] 核心库单元测试
- [ ] 宏系统测试
- [ ] 工具函数测试
- [ ] 配置系统测试

#### 9.2 集成测试
- [ ] Web 层集成测试
- [ ] 数据访问层测试
- [ ] 缓存集成测试
- [ ] 端到端测试

#### 9.3 性能测试
- [ ] 启动时间测试
- [ ] 内存使用测试
- [ ] 并发性能测试
- [ ] 数据库性能测试

#### 9.4 兼容性测试
- [ ] Rust 版本兼容性
- [ ] 依赖库兼容性
- [ ] 操作系统兼容性

## 第八阶段：优化和发布

### 10. 性能优化和发布准备

#### 10.1 性能优化
- [ ] 编译时优化
- [ ] 运行时性能调优
- [ ] 内存使用优化
- [ ] 启动时间优化

#### 10.2 安全性增强
- [ ] 输入验证加强
- [ ] SQL 注入防护
- [ ] XSS 防护
- [ ] 敏感信息保护

#### 10.3 监控和可观测性
- [ ] 指标收集系统
- [ ] 健康检查端点
- [ ] 分布式追踪支持
- [ ] 监控集成

#### 10.4 发布准备
- [ ] 版本发布流程
- [ ] 变更日志维护
- [ ] 发布说明编写
- [ ] crates.io 发布配置

## 附加任务

### 社区和生态建设
- [ ] GitHub 仓库设置
- [ ] Issue 模板配置
- [ ] PR 模板配置
- [ ] 代码审查流程
- [ ] 社区指南制定

### 持续改进
- [ ] 用户反馈收集机制
- [ ] 性能监控和分析
- [ ] 定期安全审计
- [ ] 依赖更新策略

## 📊 当前开发进度总览

### ✅ 已完成 (约 35%)
- **项目基础架构** - 100% 完成
  - Workspace 配置、开发环境、版本管理、开发规范
- **宏系统基础** - 60% 完成  
  - 基础宏框架、应用启动宏、基本组件标记宏
- **核心库** - 70% 完成
  - 配置系统、错误处理、日志系统、应用上下文、基础工具

### 🔄 进行中 (约 25%)
- **宏系统完善** - 需要完善依赖注入和 Web 注解
- **依赖注入容器** - 类型安全问题需要优化
- **基础示例** - Hello World 完成，需要更多示例

### ❌ 待开发 (约 40%)
- **Web 启动器** - 完全未开始
- **数据访问启动器** - MySQL/Redis 启动器
- **进阶示例和文档** - CRUD 示例、完整文档

## 🎯 下一步重点任务

### 第一优先级 (MVP 完成)
1. **修复依赖注入容器的类型安全问题**
2. **开发 Web 启动器基础功能**
3. **实现 HTTP 方法注解** (`#[GetMapping]`, `#[PostMapping]` 等)
4. **创建完整的 CRUD 示例**

### 第二优先级 (功能完善)  
1. **开发 MySQL 启动器**
2. **完善错误处理和全局异常处理器**
3. **添加更多实用工具和中间件**

## 📈 里程碑状态

- **M1 (基础框架可用)**: 🔄 **75% 完成** - 基础功能基本完成，需要 Web 支持
- **M2 (数据访问支持)**: ❌ **0% 完成** - 未开始
- **M3 (功能完整)**: ❌ **0% 完成** - 未开始  
- **M4 (生产就绪)**: ❌ **0% 完成** - 未开始

这份 TODO 文档涵盖了从项目初始化到发布上线的完整开发流程，每个阶段都有明确的任务划分，便于团队协作和进度跟踪。建议按照优先级和依赖关系逐步推进，确保每个阶段的质量后再进入下一阶段。